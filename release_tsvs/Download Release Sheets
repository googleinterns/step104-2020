{"files":[{"id":"9db716a4-86be-446b-aacf-723dfec5f28e","name":"Code","type":"server_js","source":"function myFunction() {\n  var ss \u003d SpreadsheetApp.openById(\"1kqFfgDY7LgYXAfjgV7lDVWENGi02qn9s373vh9xzNNY\");\n  var sheets \u003d ss.getSheets();\n  for (var s in sheets) {\n    convertRangeTotsvFile_(sheets[s].getName() + \".tsv\", sheets[s]);\n  }\n}\n\nfunction convertRangeTotsvFile_(tsvFileName, sheet) {\n  // get available data range in the spreadsheet\n  var activeRange \u003d sheet.getDataRange();\n  try {\n    var data \u003d activeRange.getValues();\n    var tsvFile \u003d undefined;\n\n    // loop through the data in the range and build a string with the tsv  data\n    if (data.length \u003e 1) {\n      var tsv \u003d \"\";\n      for (var row \u003d 0; row \u003c data.length; row++) {\n        for (var col \u003d 0; col \u003c data[row].length; col++) {\n          if (data[row][col].toString().indexOf(\"\\t\") !\u003d -1) {\n            data[row][col] \u003d \"\\\"\" + data[row][col] + \"\\\"\";\n          }\n        }\n\n        // join each row\u0027s columns\n        // add a carriage return to end of each row, except for the last one\n        if (row \u003c data.length-1) {\n          tsv +\u003d data[row].join(\"\\t\") + \"\\r\\n\";\n        }\n        else {\n        tsv +\u003d data[row].join(\"\\t\");\n             }\n      }\n      tsvFile \u003d tsv;\n    }\n    DriveApp.createFile(tsvFileName, tsvFile);\n  }\n  catch(err) {\n    Logger.log(err);\n  }\n}"},{"id":"520671d5-af86-4ee8-884c-1119f75774ed","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Pacific/Galapagos\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"}]}